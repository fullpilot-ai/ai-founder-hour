(globalThis.TURBOPACK = globalThis.TURBOPACK || []).push([typeof document === "object" ? document.currentScript : undefined, {

"[project]/node_modules/@sanity/next-loader/dist/_chunks-es/SanityLiveStream.js [app-client] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "default": (()=>SanityLiveStream)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sanity$2f$client$2f$dist$2f$_chunks$2d$es$2f$stegaEncodeSourceMap$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@sanity/client/dist/_chunks-es/stegaEncodeSourceMap.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dequal$2f$lite$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/dequal/lite/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$use$2d$effect$2d$event$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/use-effect-event/dist/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sanity$2f$next$2d$loader$2f$dist$2f$_chunks$2d$es$2f$context$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@sanity/next-loader/dist/_chunks-es/context.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
const use = "use" in __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ ? // @ts-expect-error this is fine
__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__.use : ()=>{
    throw new TypeError("SanityLiveStream requires a React version with React.use()");
}, LISTEN_HEARTBEAT_INTERVAL = 1e4;
function SanityLiveStream(props) {
    const { query, dataset, params = {}, perspective, projectId, stega } = props, subscribe = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "SanityLiveStream.useCallback[subscribe]": (listener)=>(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sanity$2f$next$2d$loader$2f$dist$2f$_chunks$2d$es$2f$context$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["comlinkListeners"].add(listener), ({
                "SanityLiveStream.useCallback[subscribe]": ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sanity$2f$next$2d$loader$2f$dist$2f$_chunks$2d$es$2f$context$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["comlinkListeners"].delete(listener)
            })["SanityLiveStream.useCallback[subscribe]"])
    }["SanityLiveStream.useCallback[subscribe]"], []), comlink$1 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useSyncExternalStore"])(subscribe, {
        "SanityLiveStream.useSyncExternalStore[comlink$1]": ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sanity$2f$next$2d$loader$2f$dist$2f$_chunks$2d$es$2f$context$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["comlink"]
    }["SanityLiveStream.useSyncExternalStore[comlink$1]"], {
        "SanityLiveStream.useSyncExternalStore[comlink$1]": ()=>null
    }["SanityLiveStream.useSyncExternalStore[comlink$1]"]), [children, setChildren] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(void 0), handleQueryHeartbeat = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$use$2d$effect$2d$event$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffectEvent"])({
        "SanityLiveStream.useEffectEvent[handleQueryHeartbeat]": (comlink2)=>{
            comlink2.post("loader/query-listen", {
                projectId,
                dataset,
                perspective,
                query,
                params,
                heartbeat: LISTEN_HEARTBEAT_INTERVAL
            });
        }
    }["SanityLiveStream.useEffectEvent[handleQueryHeartbeat]"]), handleQueryChange = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$use$2d$effect$2d$event$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffectEvent"])({
        "SanityLiveStream.useEffectEvent[handleQueryChange]": (event)=>{
            if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dequal$2f$lite$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dequal"])({
                projectId,
                dataset,
                query,
                params
            }, {
                projectId: event.projectId,
                dataset: event.dataset,
                query: event.query,
                params: event.params
            })) {
                const { result, resultSourceMap, tags } = event, data = stega ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sanity$2f$client$2f$dist$2f$_chunks$2d$es$2f$stegaEncodeSourceMap$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["stegaEncodeSourceMap"])(result, resultSourceMap, {
                    enabled: !0,
                    studioUrl: "/"
                }) : result;
                console.groupCollapsed("rendering with server action"), props.children({
                    data,
                    sourceMap: resultSourceMap,
                    tags: tags || []
                }).then({
                    "SanityLiveStream.useEffectEvent[handleQueryChange]": (children2)=>{
                        console.log("setChildren(children)"), setChildren(children2);
                    }
                }["SanityLiveStream.useEffectEvent[handleQueryChange]"], {
                    "SanityLiveStream.useEffectEvent[handleQueryChange]": (reason)=>{
                        console.error("rendering with server action: render children error", reason);
                    }
                }["SanityLiveStream.useEffectEvent[handleQueryChange]"]).finally({
                    "SanityLiveStream.useEffectEvent[handleQueryChange]": ()=>console.groupEnd()
                }["SanityLiveStream.useEffectEvent[handleQueryChange]"]);
            }
        }
    }["SanityLiveStream.useEffectEvent[handleQueryChange]"]);
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "SanityLiveStream.useEffect": ()=>{
            if (!comlink$1) return;
            const unsubscribe = comlink$1.on("loader/query-change", handleQueryChange), interval = setInterval({
                "SanityLiveStream.useEffect.interval": ()=>handleQueryHeartbeat(comlink$1)
            }["SanityLiveStream.useEffect.interval"], LISTEN_HEARTBEAT_INTERVAL);
            return ({
                "SanityLiveStream.useEffect": ()=>{
                    clearInterval(interval), unsubscribe();
                }
            })["SanityLiveStream.useEffect"];
        }
    }["SanityLiveStream.useEffect"], [
        comlink$1
    ]), !comlink$1 || children === void 0 ? use(props.initial) : /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsx"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
        children
    });
}
SanityLiveStream.displayName = "SanityLiveStream";
;
 //# sourceMappingURL=SanityLiveStream.js.map
}}),
}]);

//# sourceMappingURL=node_modules_%40sanity_next-loader_dist__chunks-es_SanityLiveStream_dea55b4f.js.map